<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>用户设置</title>
    <link href="/logo.ico" rel="icon">
    <link rel="stylesheet" href="/user.css">
    <link rel="stylesheet" href="/font-icos.css">
    <link rel="stylesheet" href="/form.css">
    <link rel="stylesheet" href="/nav.css">
    <script src="/isPhone.js" type="text/javascript"></script>
    <script src="/easyForm.js" type="text/javascript"></script>
    <script src="/connection.js" type="text/javascript"></script>
    <script src="/form.js" type="text/javascript"></script>
    <script>
        window.onedit=false
        function doedit(){
            if (window.onedit){
                birthDate=document.getElementById("birthDate").value
                sex=parseInt(getRadioButtonCheckedValue("birthSex"))
                if (birthDate==""){
                    showMessage("请输入出生日期",()=>{
                        document.getElementById("birthDate").focus()
                    })
                    return
                }
                if (birthDate===window.info.birthDate && sex===window.info.sex){
                    document.getElementById("birthDate").disabled=true
                    document.getElementById("sexBoy").disabled=true
                    document.getElementById("sexGirl").disabled=true
                    document.getElementById("edit").value="编辑"
                    window.onedit=false
                    return
                }
                changeInfo(birthDate,sex).then((retsults)=>{
                    if (retsults){
                        document.getElementById("birthDate").disabled=true
                        document.getElementById("sexBoy").disabled=true
                        document.getElementById("sexGirl").disabled=true
                        document.getElementById("edit").value="编辑"
                        window.info.birthDate=birthDate
                        window.info.sex=sex
                        showMessage("保存成功")
                        window.onedit=false
                    }else{
                        location.href = "/login?from=/user/";
                    }
                })

            }else{
                document.getElementById("birthDate").disabled=false
                document.getElementById("sexBoy").disabled=false
                document.getElementById("sexGirl").disabled=false
                window.onedit=true
                document.getElementById("edit").value="保存"
            }
        }
        window.onload=()=>{
            isPhone()
            getInfo().then((retsult)=>{
                if (retsult==null){
                    location.href = "/login?from=/user/";
                }else{
                    window.info=retsult
                    document.getElementById("birthDate").value=retsult.birthDate
                    if  (retsult.sex==0){
                        document.getElementById("sexBoy").checked=true
                    }else{
                        document.getElementById("sexGirl").checked=true
                    }
                    document.getElementById("title").innerText=retsult.name+"的用户主页"
                }
            }) 
        }
        function dochangePassword(){
            location.href = "/check/image/?from=/check/email?from=/user/changePassword"
        }
        function dochangeEmail(){
            location.href = "/check/image/?from=/check/email?from=/user/changeEmail"
        }
        function dologout(){
            localStorage.removeItem("check")
            location.href = "/"
        }
    </script>
</head>

<body>
    <header>
        <div id="titleGroup">
            <h1 id="title"></h1>
        </div>
    </header>
    
    <div id="nav">
        <ul>
            <li><a href="/"><p>主页<b class="demo-icon">&#xe800;</b></p></a></li>
            <li><a href="/blogs/"><p>博客<b class="demo-icon">&#xe801;</b></p></a></li>
            <li id="helpNav"><a href="/docs/"><p>帮助<b class="demo-icon">&#xe802;</b></p></a><div id="helpSonNav">
                <ul>
                <li><a href="/docs/qq-robot/"><p>QQ机器人(智障宽宽)</p></a></li>
                <li><a href="/docs/self-made-pvz/"><p>(合作)自制pvz</p></a></li>
                <li><a href="/docs/dns-speed-measurement/"><p>DNS测速</p></a></li>
                <li><a href="/docs/ghm-base64-encoder/"><p>GHM-BASE64编码器</p></a></li>
                <li><a href="/docs/smart-reply/"><p>智能回复</p></a></li>
                <li><a href="/docs/folder-synchronization/"><p>文件夹同步</p></a></li>
                <li><a href="/docs/connector/"><p>连点器</p></a></li>
                <li><a href="/docs/simple-chat-software/"><p>消息收发简易</p></a></li>
                <li><a href="/docs/excel-pinyin/"><p>Excel汉字转拼音</p></a></li>
                <li><a href="/docs/handwritten-text-generator/"><p>手写体生成器</p></a></li>
                <li><a href="/docs/multithreaded-download/"><p>多线程下载</p></a></li>
                <li><a href="/docs/long-polling/"><p>长轮询</p></a></li>
                <li><a href="/docs/do-folder/"><p>文件夹管理</p></a></li>

                </ul>
            </div></li>
            <li><a href="/words/"><p>一言<b class="demo-icon">&#xe803;</b></p></a></li>
            <li><a href="/contactInformation/"><p>联系我们<b class="demo-icon">&#xf2b9;</b></p></a></li>
            <li><a href="/feedback/"><p>反馈<b class="demo-icon">&#xf2b6;</b></p></a></li>
            <li><a href="/chat/"><p>聊天<b class="demo-icon">&#xe813;</b></p></a></li>
            <li><a href="/chatgpt/"><p>ChatGPT<b class="demo-icon">&#xf18d;</b></p></a></li>
            <li><a href="https://gitee.com/kuankuan2007"><p>Gitee<b class="demo-icon">&#xf053;</b></p></a></li>
            <li><a href="https://gitlab.com/kuankuan2007"><p>Gitlab<b class="demo-icon">&#xe814;</b></p></a></li>
            <li><a href="https://github.com/kuankuan2007"><p>Github<b class="demo-icon">&#xf056;</b></p></a></li>
        </ul>
        <div id="navHoverBackground"></div>
    </div>

    <form id="form">
        <div class="formPart">
            <div class="formDate">
                <span>出生日期</span>
                <input type="date" id="birthDate" class="inputDate" disabled="disabled">
            </div>
            <div class="formSex">
                <span>性别</span>
                <div class="formSexInput">
                    <div class="formSexChoice">
                        <input type="radio" name="birthSex" id="sexBoy" class="inputSex" value="0"  disabled="disabled">
                        <span>男</span>
                    </div>
                    <div class="formSexChoice">
                        <input type="radio" name="birthSex" id="sexGirl" class="inputSex" value="1" disabled="disabled">
                        <span>女</span>
                    </div>
                </div>
            </div>
            <input type="button" id="edit" onclick="doedit()" class="inputButton" value="编辑">
        </div>
        <div class="formPart">
            <input type="button" id="changePassword" onclick="dochangePassword()" class="inputButton" value="更改密码">
            <input type="button" id="changeEmail" onclick="dochangeEmail()" class="inputButton" value="更改邮箱">
        </div>
        <div>
            <input type="button" id="logout" class="inputButton" onclick="dologout()" value="退出登录">
        </div>
    </form>
</body>